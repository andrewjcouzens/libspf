<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libSPF v1.0: util.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>util.h</h1><a href="util_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/* libspf - Sender Policy Framework library</span>
00002 <span class="comment">*</span>
00003 <span class="comment">*  ANSI C implementation of spf-draft-200405.txt</span>
00004 <span class="comment">*</span>
00005 <span class="comment">*  Author: James Couzens &lt;jcouzens@codeshare.ca&gt;</span>
00006 <span class="comment">*  Author: Sean Comeau   &lt;scomeau@obscurity.org&gt;</span>
00007 <span class="comment">*</span>
00008 <span class="comment">*  File:   util.h</span>
00009 <span class="comment">*  Desc:   Utility function header file</span>
00010 <span class="comment">*</span>
00011 <span class="comment">*  License:</span>
00012 <span class="comment">*</span>
00013 <span class="comment">*  The libspf Software License, Version 1.0</span>
00014 <span class="comment">*</span>
00015 <span class="comment">*  Copyright (c) 2004 James Couzens &amp; Sean Comeau  All rights</span>
00016 <span class="comment">*  reserved.</span>
00017 <span class="comment">*</span>
00018 <span class="comment">*  Redistribution and use in source and binary forms, with or without</span>
00019 <span class="comment">*  modification, are permitted provided that the following conditions</span>
00020 <span class="comment">*  are met:</span>
00021 <span class="comment">*</span>
00022 <span class="comment">*  1. Redistributions of source code must retain the above copyright</span>
00023 <span class="comment">*     notice, this list of conditions and the following disclaimer.</span>
00024 <span class="comment">*</span>
00025 <span class="comment">*  2. Redistributions in binary form must reproduce the above copyright</span>
00026 <span class="comment">*     notice, this list of conditions and the following disclaimer in</span>
00027 <span class="comment">*     the documentation and/or other materials provided with the</span>
00028 <span class="comment">*     distribution.</span>
00029 <span class="comment">*</span>
00030 <span class="comment">*  THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED</span>
00031 <span class="comment">*  WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span>
00032 <span class="comment">*  OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
00033 <span class="comment">*  DISCLAIMED.  IN NO EVENT SHALL THE AUTHORS MAKING USE OF THIS LICESEN</span>
00034 <span class="comment">*  OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
00035 <span class="comment">*  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
00036 <span class="comment">*  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF</span>
00037 <span class="comment">*  USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
00038 <span class="comment">*  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
00039 <span class="comment">*  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT</span>
00040 <span class="comment">*  OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span>
00041 <span class="comment">*  SUCH DAMAGE.</span>
00042 <span class="comment">*</span>
00043 <span class="comment">*/</span>
00044 
00045 
00046 <span class="preprocessor">#ifndef _UTIL_H</span>
<a name="l00047"></a><a class="code" href="util_8h.html#a0">00047</a> <span class="preprocessor"></span><span class="preprocessor">#define _UTIL_H 1</span>
00048 <span class="preprocessor"></span>
00049 <span class="preprocessor">#include "../../config.h"</span>    <span class="comment">/* autoconf */</span>
00050 <span class="preprocessor">#include &lt;stdio.h&gt;</span>           <span class="comment">/* stdin / stdout */</span>
00051 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>          <span class="comment">/* malloc / free */</span>
00052 <span class="preprocessor">#include &lt;stdarg.h&gt;</span>          <span class="comment">/* va_sprintf */</span>
00053 <span class="preprocessor">#include &lt;string.h&gt;</span>          <span class="comment">/* strstr / strdup */</span>
00054 <span class="preprocessor">#include &lt;strings.h&gt;</span>         <span class="comment">/* strcasecmp */</span>
00055 <span class="preprocessor">#include &lt;unistd.h&gt;</span>          <span class="comment">/* ? exit? */</span>
00056 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>      <span class="comment">/* inet_ functions / structs */</span>
00057 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>      <span class="comment">/* inet_ functions / structs */</span>
00058 <span class="preprocessor">#include &lt;time.h&gt;</span>            <span class="comment">/* time_t */</span>
00059 <span class="preprocessor">#include &lt;ctype.h&gt;</span>           <span class="comment">/* isdigit .. */</span>
00060 
00061 <span class="preprocessor">#ifdef _WITH_SOLARIS</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#include &lt;link.h&gt;</span>            <span class="comment">/* uintptr_t */</span>
00063 <span class="preprocessor">#elif defined(__FreeBSD__)</span>
00064 <span class="preprocessor"></span><span class="preprocessor">#include &lt;inttypes.h&gt;</span>        <span class="comment">/* uintptr_t */</span>
00065 <span class="preprocessor">#else</span>
00066 <span class="preprocessor"></span><span class="preprocessor">#include &lt;stdint.h&gt;</span>          <span class="comment">/* uintptr_t */</span>
00067 <span class="preprocessor">#endif </span><span class="comment">/* _WITH_SOLARIS */</span>
00068 
00069 <span class="preprocessor">#ifdef _HAVE_INTTYPES_H</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#include &lt;inttypes.h&gt;</span>
00071 <span class="preprocessor">#endif </span><span class="comment">/* HAVE_INTTYPES_H */</span>
00072 
00073 <span class="preprocessor">#include "<a class="code" href="main_8h.html">main.h</a>"</span>            <span class="comment">/* for the flags man */</span>
00074 
00075 <span class="preprocessor">#ifdef _WITH_PTHREADS</span>
00076 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="dns_8h.html">dns.h</a>"</span>             <span class="comment">/* xgethostbyname */</span>
00077 <span class="preprocessor">#endif </span><span class="comment">/* _WITH_PTHREADS */</span>
00078 
00079 <span class="preprocessor">#ifdef  HAVE__BEGIN_DECLS</span>
00080 <span class="preprocessor"></span>__BEGIN_DECLS
00081 <span class="preprocessor">#else</span>
00082 <span class="preprocessor"></span><span class="preprocessor"># ifdef __cplusplus</span>
00083 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
00084 <span class="preprocessor"># endif </span><span class="comment">/* __cplusplus */</span>
00085 <span class="preprocessor">#endif </span><span class="comment">/* HAVE__BEGIN_DECLS */</span>
00086 
00087 
00088 
00089  <span class="comment">/*</span>
00090 <span class="comment"> *  define declarations</span>
00091 <span class="comment"> *</span>
00092 <span class="comment">*/</span>
00093 
00094 <span class="comment">/* maximum size of buffer for date time stamp */</span>
<a name="l00095"></a><a class="code" href="util_8h.html#a1">00095</a> <span class="preprocessor">#define SPF_MAX_DATETIME 26</span>
00096 <span class="preprocessor"></span>
00097 <span class="comment">/* max size of gethostbyname_r data buffer */</span>
<a name="l00098"></a><a class="code" href="util_8h.html#a2">00098</a> <span class="preprocessor">#define SPF_MAX_GHBNR_DBUF 2048</span>
00099 <span class="preprocessor"></span>
00100 
00101  <span class="comment">/*</span>
00102 <span class="comment"> * In ANSI C, and indeed any rational implementation, size_t is also the</span>
00103 <span class="comment"> * type returned by sizeof().  However, it seems there are some irrational</span>
00104 <span class="comment"> * implementations out there, in which sizeof() returns an int even though</span>
00105 <span class="comment"> * size_t is defined as long or unsigned long.  To ensure consistent results</span>
00106 <span class="comment"> * we always use this SIZEOF() macro in place of using sizeof() directly.</span>
00107 <span class="comment">*/</span>
<a name="l00108"></a><a class="code" href="util_8h.html#a3">00108</a> <span class="preprocessor">#define SIZEOF(object)  ((size_t) sizeof(object))</span>
00109 <span class="preprocessor"></span>
00110 
00111 <span class="preprocessor">#ifndef HAVE___FUNCTION__</span>
00112 <span class="preprocessor"></span><span class="preprocessor"># ifdef HAVE___FUNC__</span>
00113 <span class="preprocessor"></span><span class="preprocessor">#  define __FUNCTION__  __func__</span>
00114 <span class="preprocessor"></span><span class="preprocessor"># else</span>
00115 <span class="preprocessor"></span><span class="preprocessor">#  define __FUNCTION__  "?"</span>
00116 <span class="preprocessor"></span><span class="preprocessor"># endif </span><span class="comment">/* HAVE___FUNC__ */</span>
00117 <span class="preprocessor">#endif </span><span class="comment">/* HAVE___FUNCTION__ */</span>
00118 
00119 
00120  <span class="comment">/*</span>
00121 <span class="comment"> *  memory allocation and string handling wrapper macros</span>
00122 <span class="comment"> *</span>
00123 <span class="comment">*/</span>
00124 
<a name="l00125"></a><a class="code" href="util_8h.html#a4">00125</a> <span class="preprocessor">#define xmalloc(n)      UTIL_malloc(n, __FILE__, __LINE__, __FUNCTION__)</span>
<a name="l00126"></a><a class="code" href="util_8h.html#a5">00126</a> <span class="preprocessor"></span><span class="preprocessor">#define xrealloc(m, n)  UTIL_realloc(m, n, __FILE__, __LINE__, __FUNCTION__)</span>
<a name="l00127"></a><a class="code" href="util_8h.html#a6">00127</a> <span class="preprocessor"></span><span class="preprocessor">#define xfree(m)        UTIL_free(m, __FILE__, __LINE__, __FUNCTION__)</span>
<a name="l00128"></a><a class="code" href="util_8h.html#a7">00128</a> <span class="preprocessor"></span><span class="preprocessor">#define xstrdup(m)      UTIL_strdup(m)</span>
<a name="l00129"></a><a class="code" href="util_8h.html#a8">00129</a> <span class="preprocessor"></span><span class="preprocessor">#define xstrndup(m, n)  UTIL_strndup(m, n)</span>
00130 <span class="preprocessor"></span>
00131 
00132  <span class="comment">/*</span>
00133 <span class="comment"> *  printf wrapper macros</span>
00134 <span class="comment"> *</span>
00135 <span class="comment">*/</span>
00136 
00137 <span class="comment">/* printf with variadic macros */</span>
<a name="l00138"></a><a class="code" href="util_8h.html#a9">00138</a> <span class="preprocessor">#define xprintf(format,...) \</span>
00139 <span class="preprocessor">  dbg_printf(FL_A, __FUNCTION__, __FILE__, __LINE__, format, __VA_ARGS__)</span>
00140 <span class="preprocessor"></span>
00141 <span class="comment">/* more verbose printf with variadic macros */</span>
<a name="l00142"></a><a class="code" href="util_8h.html#a10">00142</a> <span class="preprocessor">#define xvprintf(format,...) \</span>
00143 <span class="preprocessor">  dbg_printf(FL_B, __FUNCTION__, __FILE__, __LINE__, format, __VA_ARGS__)</span>
00144 <span class="preprocessor"></span>
00145 <span class="comment">/* printf without variadic macros (passing only a single string) */</span>
<a name="l00146"></a><a class="code" href="util_8h.html#a11">00146</a> <span class="preprocessor">#define xpprintf(s) \</span>
00147 <span class="preprocessor">  dbg_pprintf(FL_D, __FUNCTION__, __FILE__, __LINE__, s) </span>
00148 <span class="preprocessor"></span>
00149 <span class="comment">/* error printf with variadic macros */</span>
<a name="l00150"></a><a class="code" href="util_8h.html#a12">00150</a> <span class="preprocessor">#define xeprintf(format,...) \</span>
00151 <span class="preprocessor">  dbg_printf(FL_E, __FUNCTION__, __FILE__, __LINE__, format, __VA_ARGS__)</span>
00152 <span class="preprocessor"></span>
00153 <span class="comment">/* error printf without variadic macros */</span>
<a name="l00154"></a><a class="code" href="util_8h.html#a13">00154</a> <span class="preprocessor">#define xepprintf(s)  \</span>
00155 <span class="preprocessor">  dbg_pprintf(FL_F, __FUNCTION__, __FILE__, __LINE__, s)</span>
00156 <span class="preprocessor"></span>
00157 
00158  <span class="comment">/*</span>
00159 <span class="comment"> *  threading wrapper macros</span>
00160 <span class="comment"> *</span>
00161 <span class="comment">*/</span>
00162 
<a name="l00163"></a><a class="code" href="util_8h.html#a14">00163</a> <span class="preprocessor">#define xpthread_mutex_lock(m)   _UTIL_pthread_mutex(m, SPF_TRUE)</span>
<a name="l00164"></a><a class="code" href="util_8h.html#a15">00164</a> <span class="preprocessor"></span><span class="preprocessor">#define xpthread_mutex_unlock(m) _UTIL_pthread_mutex(m, SPF_FALSE)</span>
00165 <span class="preprocessor"></span>
00166 
00167 <span class="comment">/* for handing debug modes */</span>
<a name="l00168"></a><a class="code" href="util_8h.html#a16">00168</a> <span class="preprocessor">#define f_bit_set(fl_bit_vector, bit) ((int)((fl_bit_vector)&amp;(bit)))</span>
00169 <span class="preprocessor"></span>
00170 <span class="comment">/* this table and macro came from wget more or less */</span>
<a name="l00171"></a><a class="code" href="util_8h.html#a17">00171</a> <span class="preprocessor">#define urlchr_test(c) (urlchr_table[(unsigned char)(c)] &amp; 1)</span>
<a name="l00172"></a><a class="code" href="util_8h.html#a22">00172</a> <span class="preprocessor"></span><span class="keyword">static</span> <span class="keyword">const</span> u_char <a class="code" href="util_8h.html#a22">urlchr_table</a>[256] =
00173 {
00174   1,  1,  1,  1,   1,  1,  1,  1,   <span class="comment">/* NUL SOH STX ETX  EOT ENQ ACK BEL */</span>
00175   1,  1,  1,  1,   1,  1,  1,  1,   <span class="comment">/* BS  HT  LF  VT   FF  CR  SO  SI  */</span>
00176   1,  1,  1,  1,   1,  1,  1,  1,   <span class="comment">/* DLE DC1 DC2 DC3  DC4 NAK SYN ETB */</span>
00177   1,  1,  1,  1,   1,  1,  1,  1,   <span class="comment">/* CAN EM  SUB ESC  FS  GS  RS  US  */</span>
00178   1,  0,  1,  1,   0,  1,  1,  0,   <span class="comment">/* SP  !   "   #    $   %   &amp;   '   */</span>
00179   0,  0,  0,  1,   0,  0,  0,  1,   <span class="comment">/* (   )   *   +    ,   -   .   /   */</span>
00180   0,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* 0   1   2   3    4   5   6   7   */</span>
00181   0,  0,  1,  1,   1,  1,  1,  1,   <span class="comment">/* 8   9   :   ;    &lt;   =   &gt;   ?   */</span>
00182   1,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* @   A   B   C    D   E   F   G   */</span>
00183   0,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* H   I   J   K    L   M   N   O   */</span>
00184   0,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* P   Q   R   S    T   U   V   W   */</span>
00185   0,  0,  0,  1,   1,  1,  1,  0,   <span class="comment">/* X   Y   Z   [    \   ]   ^   _   */</span>
00186   1,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* `   a   b   c    d   e   f   g   */</span>
00187   0,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* h   i   j   k    l   m   n   o   */</span>
00188   0,  0,  0,  0,   0,  0,  0,  0,   <span class="comment">/* p   q   r   s    t   u   v   w   */</span>
00189   0,  0,  0,  1,   1,  1,  1,  1,   <span class="comment">/* x   y   z   {    |   }   ~   DEL */</span>
00190 
00191   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00192   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00193   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00194   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00195 
00196   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00197   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00198   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00199   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,   1,  1,  1,  1,
00200 };
00201 
00202 
00203 
00204  <span class="comment">/*</span>
00205 <span class="comment"> * Debug logging / Debug dummy wrappers </span>
00206 <span class="comment"> *</span>
00207 <span class="comment">*/</span>
00208 
00209 <span class="comment">/* output file for debugging */</span>
<a name="l00210"></a><a class="code" href="util_8h.html#a18">00210</a> <span class="preprocessor">#define DEBUG_LOG_FILE "/var/log/spf.log"</span>
00211 <span class="preprocessor"></span>
00212 <span class="comment">/* output file for transaction logging */</span>
<a name="l00213"></a><a class="code" href="util_8h.html#a19">00213</a> <span class="preprocessor">#define OUTPUT_LOG_FILE "/var/log/spflog.txt"</span>
00214 <span class="preprocessor"></span>
00215 <span class="preprocessor">#if defined _SPF_DEBUG</span>
00216 <span class="preprocessor"></span><span class="preprocessor">#define dbg_printf _printf_dbg</span>
00217 <span class="preprocessor"></span><span class="preprocessor">#define dbg_pprintf _pprintf_dbg</span>
00218 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00219 <span class="preprocessor"></span>
00220 <span class="preprocessor">#ifndef _SPF_DEBUG</span>
<a name="l00221"></a><a class="code" href="util_8h.html#a20">00221</a> <span class="preprocessor"></span><span class="preprocessor">#define dbg_printf _dummy_debug</span>
<a name="l00222"></a><a class="code" href="util_8h.html#a21">00222</a> <span class="preprocessor"></span><span class="preprocessor">#define dbg_pprintf _dummy_pdebug</span>
00223 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00224 <span class="preprocessor"></span>
00225 
00226 
00227  <span class="comment">/*</span>
00228 <span class="comment"> *  function declarations</span>
00229 <span class="comment"> *</span>
00230 <span class="comment">*/</span>
00231 
00232 
00233  <span class="comment">/*</span>
00234 <span class="comment"> * Debugging</span>
00235 <span class="comment"> *</span>
00236 <span class="comment">*/</span>
00237 <span class="keywordtype">void</span> <a class="code" href="util_8h.html#a24">_printf_dbg</a>(<span class="keyword">const</span> u_int8_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> size_t, 
00238   <span class="keyword">const</span> <span class="keywordtype">char</span> *, ...);
00239 
00240 <span class="keywordtype">void</span> <a class="code" href="util_8h.html#a25">_pprintf_dbg</a>(<span class="keyword">const</span> u_int8_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> size_t,
00241   <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00242 
00243 <span class="keywordtype">void</span> <a class="code" href="util_8h.html#a26">_dummy_debug</a>(<span class="keyword">const</span> u_int8_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> size_t,
00244   <span class="keyword">const</span> <span class="keywordtype">char</span> *, ...);
00245 
00246 <span class="keywordtype">void</span> <a class="code" href="util_8h.html#a27">_dummy_pdebug</a>(<span class="keyword">const</span> u_int8_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> size_t,
00247   <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00248 
00249 
00250  <span class="comment">/*</span>
00251 <span class="comment"> * Memory allocation / deallocation</span>
00252 <span class="comment"> *</span>
00253 <span class="comment">*/</span>
00254 
00255 <span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a28">UTIL_malloc</a>(<span class="keyword">const</span> int32_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int32_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00256 <span class="keywordtype">void</span> *<a class="code" href="util_8h.html#a29">UTIL_realloc</a>(<span class="keywordtype">void</span> *, <span class="keyword">const</span> int32_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int32_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00257 <span class="keywordtype">void</span>  <a class="code" href="util_8h.html#a30">UTIL_free</a>(<span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int32_t, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00258 
00259 
00260  <span class="comment">/*</span>
00261 <span class="comment"> * String handling / SPF query handling (string related)</span>
00262 <span class="comment"> *</span>
00263 <span class="comment">*/</span>
00264 
00265 <span class="keywordtype">void</span>      <a class="code" href="util_8h.html#a31">UTIL_log_result</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *);
00266 <span class="keywordtype">char</span>     *<a class="code" href="util_8c.html#a6">UTIL_get_date</a>(<span class="keywordtype">void</span>);
00267 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a33">UTIL_strndup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> size_t);
00268 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a34">UTIL_strdup</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00269 int16_t   <a class="code" href="util_8h.html#a35">UTIL_index</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span>);
00270 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a36">UTIL_split_str</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span>, <span class="keyword">const</span> u_int8_t);
00271 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a37">UTIL_split_strr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span>, <span class="keyword">const</span> u_int8_t);
00272 u_int8_t  <a class="code" href="util_8h.html#a38">UTIL_count_delim</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span>);
00273 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a39">UTIL_is_spf_delim</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>);
00274 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a40">UTIL_is_spf_result</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>);
00275 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a41">UTIL_is_macro</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00276 
00277 
00278  <span class="comment">/*</span>
00279 <span class="comment"> * SPF Mechanism parsing</span>
00280 <span class="comment"> *</span>
00281 <span class="comment">*/</span>
00282 
00283 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a42">UTIL_mx_cmp</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int8_t);
00284 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a43">UTIL_a_cmp</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int8_t);
00285 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a44">UTIL_ptr_cmp</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00286 
00287 
00288  <span class="comment">/*</span>
00289 <span class="comment"> * General utility</span>
00290 <span class="comment"> *</span>
00291 <span class="comment">*/</span>
00292 
00293 <a class="code" href="spf_8h.html#a38">SPF_MECHANISM</a> <a class="code" href="util_8h.html#a45">UTIL_get_policy_mech</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00294 <a class="code" href="spf_8h.html#a36">SPF_RESULT</a>    <a class="code" href="util_8h.html#a46">UTIL_get_mech_prefix</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00295 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>      <a class="code" href="util_8h.html#a47">UTIL_assoc_prefix</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <a class="code" href="spf_8h.html#a36">SPF_RESULT</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
00296 <a class="code" href="structpolicy__addr__s.html">policy_addr_t</a> *<a class="code" href="util_8h.html#a48">UTIL_expand_ip</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00297 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>      <a class="code" href="util_8h.html#a39">UTIL_is_spf_delim</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> );
00298 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>      <a class="code" href="util_8h.html#a49">UTIL_is_ip</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00299 
00300 
00301  <span class="comment">/*</span>
00302 <span class="comment"> * DNS related parsing </span>
00303 <span class="comment"> *</span>
00304 <span class="comment">*/</span>
00305 
00306 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a50">UTIL_rev_addr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00307 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a51">UTIL_get_dname</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00308 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a52">UTIL_cidr_cmp</a>(<span class="keyword">const</span> <a class="code" href="structpolicy__addr__s.html">policy_addr_t</a> *, <span class="keyword">const</span> <span class="keyword">struct</span> in_addr *);
00309 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a53">UTIL_validate_ptr</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *);
00310 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a54">UTIL_validate_hostname</a>(<a class="code" href="structpeer__info__s.html">peer_info_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> int8_t);
00311 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a55">UTIL_url_encode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *);
00312 <span class="keywordtype">char</span>     *<a class="code" href="util_8h.html#a56">UTIL_reverse</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span>);
00313 <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>  <a class="code" href="util_8h.html#a57">UTIL_addnode</a>(<a class="code" href="structsplit__str__s.html">split_str_t</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>);
00314 
00315 
00316  <span class="comment">/*</span>
00317 <span class="comment"> * Threading (linux pthreads)</span>
00318 <span class="comment"> *</span>
00319 <span class="comment">*/</span>
00320 
00321 <span class="keywordtype">void</span> <a class="code" href="util_8h.html#a58">_UTIL_pthread_mutex</a>(<span class="keywordtype">void</span> *, <a class="code" href="spf_8h.html#a35">SPF_BOOL</a>);
00322 
00323 
00324 <span class="preprocessor">#ifdef _WITH_PTHREADS</span>
00325 <span class="preprocessor"></span>
00326 <span class="comment">/* pthreads utility mutex (used by debugging and date/time) */</span>
00327 <span class="keyword">extern</span> pthread_mutex_t <a class="code" href="util_8c.html#a0">util_mutex</a>;
00328 
00329 <span class="preprocessor">#else</span>
00330 <span class="preprocessor"></span>
00331 <span class="comment">/* pthreads utility mutex dummy wrapper */</span>
00332 <span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code" href="util_8c.html#a0">util_mutex</a>; 
00333 
00334 <span class="preprocessor">#endif </span><span class="comment">/* _WITH_PTHREADS */</span>
00335 
00336 
00337 <span class="preprocessor">#ifdef  HAVE__BEGIN_DECLS</span>
00338 <span class="preprocessor"></span>__END_DECLS <span class="comment">/* _UTIL_H */</span>
00339 <span class="preprocessor">#else</span>
00340 <span class="preprocessor"></span><span class="preprocessor"># ifdef __cplusplus</span>
00341 <span class="preprocessor"></span>}
00342 <span class="preprocessor"># endif </span><span class="comment">/* __cplusplus */</span>
00343 <span class="preprocessor">#endif </span><span class="comment">/* HAVE__BEGIN_DECLS */</span>
00344 
00345 <span class="preprocessor">#endif </span><span class="comment">/* _UTIL_H */</span>
00346 
00347 <span class="comment">/* end util.h */</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Thu Sep 16 18:10:47 2004 for libSPF v1.0 by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
